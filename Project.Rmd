---
title: "Data Analytics CA Pair Project - VR Jungian Sandplay"
author: "Charlie Duff, Adam Heaton, Ademide Adenuga"
date: "December, 2022"
output:
  pdf_document:
    toc: yes
  html_document:
    code_folding: show
    toc: yes
    toc_float: no
    number_sections: yes
    df_print: paged
  word_document:
    toc: yes
    
---
```{r Load Data, echo=FALSE}
file_name = "data/daie_ca3_data_8.csv"
patient_data <- read.csv(file_name)

patient_data$pre_trial_cpss[is.na(patient_data$pre_trial_cpss)] <- mean(patient_data$pre_trial_cpss,na.rm = TRUE)


```


# Abstract

## Aim and Rationale
The aim and rationale of this project is to formulate a single hypothesis based on a set of data we were given on an experiment conducted to attempt to determine the effectiveness of use of VR technology in Jungian Sandbox therapy, comparing the effectiveness of the approaches based on the data we were provided, and cleaning up any data that requires cleanup. 

## Participants and setting
Participants of this experiment were psychotherapy patients undergoing treatment for PTSD, aged between 18 - 25 years old with no exact ages of the participants recorded. 150 participants were recorded in this study with an equal amount of male and female participants recorded. (Male = 75 / Female = 75)
Participants were broken into 3 groups using random sampling.These groups were Control (traditional CBT, w/ No VR), Static (Non-animated model content, w/ VR), Animated (Animated model content, w/ VR)

## Experiment design
Each patient spent 50 minutes per week for 12 weeks with a therapist, under three testing groups:

**Control:**
Undergoing traditional CBT with a therapist

**Static:**
Using the VR app with non-animated model content

**Animated:**
Using the VR app with animated content. 


## Results gathering
Results were tracked in an excel spreadsheet detailing the gender and test group of each participant (Control, Static, Animated) along with their CPSS (Child PTSD Symptom Scale) and OR (Observer Rating) pre and post treatment.

## Major findings
We found that the average PTSD rating for each testing group decreased after treatment.

## Findings/Implecations


# Introduction

## Topic and context

## Rationale
The Rationale behind this experiment was to determine if using VR technology in a Jungian Sandbox setting could be beneficial in reducing the PTSD levels in patients. 

## Hypothesis


# Method

## Participants
Participants of this experiment were young adults aged between 18 - 25 years old with no exact ages of the participants recorded. 150 participants were recorded in this study with an equal amount of male and female participants recorded. (Male = 75 / Female = 75)
Participants were broken into 3 groups using random sampling. These groups were Control (traditional CBT, w/ No VR), Static (Non-animated model content, w/ VR), Animated (Animated model content, w/ VR)

## Design
Upon first analysis of the data, a missing datum was found for participant 100 in their Pre-Trial Self Reported CPSS. Between the group, we discussed our options. Between ourselves, two conflicting ideas emerged - one, that we ignore the missing data and calculate results without it (deletion), and the other that we replace the missing data with a suitable value and proceed with an adjusted dataset (imputation).

First we analysed the missing datum to be Missing Completely at Random (MCAR), as being the sole unrecorded datum in the set, we can conclude that it being missing has nothing to do with any other observed variables (data Missing at Random), or missing due to the values themselves (Missing Not at Random). 

We then discussed how we could impute the missing datum. Based on research, we decided to use the mean of all Pre-Trial Self Reported CPSS values as the missing datum.

## Materials

## Procedure

# Results
```{r table, echo=FALSE}
knitr::kable(patient_data,
  align = c('c'), # a vector with 'c', 'l', or 'r' values
  digits = 2,
  caption = "Patient Data")

pre_trial_cpss_mean <- mean(patient_data$pre_trial_cpss)

```

 
```{r Summary, echo=FALSE}
summary(patient_data)

```
## Graphs
```{r Graphs, echo=FALSE}

plot(density(patient_data$pre_trial_cpss,na.rm = TRUE))
plot(density(patient_data$post_trial_cpss,na.rm = TRUE))
plot(density(patient_data$pre_trial_or,na.rm = TRUE))
plot(density(patient_data$post_trial_or,na.rm = TRUE))


#CPSS Static, Control, Animated
plot(patient_data$pre_trial_cpss[1:50] ~ patient_data$post_trial_cpss[1:50], type="p",xlim = c(0,10), ylim = c(0,10), patient_data, main = "Self Reported Data - Static CPSS", xlab = "Pre-Trial Report", ylab = "Post Trial Report")

plot(patient_data$pre_trial_cpss[51:100] ~ patient_data$post_trial_cpss[51:100], type="p",xlim = c(0,10), ylim = c(0,10), patient_data, main = "Self Reported Data - Control CPSS", xlab = "Pre-Trial Report", ylab = "Post Trial Report")

plot(patient_data$pre_trial_cpss[101:150] ~ patient_data$post_trial_cpss[101:150], type="p",xlim = c(0,10), ylim = c(0,10), patient_data, main = "Self Reported Data - Animated CPSS", xlab = "Pre-Trial Report", ylab = "Post Trial Report")



#OR Static, Control, Animated
plot(patient_data$pre_trial_or[1:50] ~ patient_data$post_trial_or[1:50], type="p",xlim = c(0,10), ylim = c(0,10), patient_data, main = "Self Reported Data - Static OR", xlab = "Pre-Trial Report", ylab = "Post Trial Report")

plot(patient_data$pre_trial_or[51:100] ~ patient_data$post_trial_or[51:100], type="p",xlim = c(0,10), ylim = c(0,10), patient_data, main = "Self Reported Data - Control OR", xlab = "Pre-Trial Report", ylab = "Post Trial Report")

plot(patient_data$pre_trial_or[101:150] ~ patient_data$post_trial_or[101:150], type="p",xlim = c(0,10), ylim = c(0,10), patient_data, main = "Self Reported Data - Animated OR", xlab = "Pre-Trial Report", ylab = "Post Trial Report")

```

## Descriptive statistics
```{r DesStats, include=FALSE}
pre_trial_cpss_meanStatic <- mean(patient_data$pre_trial_cpss[1:50],na.rm = TRUE )
post_trial_cpss_meanStatic <- mean(patient_data$post_trial_cpss[1:50],na.rm = TRUE )

pre_trial_cpss_meanControl <- mean(patient_data$pre_trial_cpss[51:100],na.rm = TRUE )
post_trial_cpss_meanControl <- mean(patient_data$post_trial_cpss[51:100],na.rm = TRUE )

pre_trial_cpss_meanAnimated <- mean(patient_data$pre_trial_cpss[101:150],na.rm = TRUE )
post_trial_cpss_meanAnimated <- mean(patient_data$post_trial_cpss[101:150],na.rm = TRUE )



pre_trial_or_meanStatic <- mean(patient_data$pre_trial_or[1:50],na.rm = TRUE )
post_trial_or_meanStatic <- mean(patient_data$post_trial_or[1:50],na.rm = TRUE )

pre_trial_or_meanControl <- mean(patient_data$pre_trial_or[51:100],na.rm = TRUE )
post_trial_or_meanControl <- mean(patient_data$post_trial_or[51:100],na.rm = TRUE )

pre_trial_or_meanAnimated <- mean(patient_data$pre_trial_or[101:150],na.rm = TRUE )
post_trial_or_meanAnimated <- mean(patient_data$post_trial_or[101:150],na.rm = TRUE )


pre_trial_cpss_std <- sd(patient_data$pre_trial_cpss,na.rm = TRUE )
post_trial_cpss_std <- sd(patient_data$post_trial_cpss)
pre_trial_or_std<- sd(patient_data$pre_trial_or)
post_trial_or_std <- sd(patient_data$post_trial_or)

```
Static Pre trial cpss mean = `r pre_trial_cpss_meanStatic`

Static Post trial cpss mean = `r post_trial_cpss_meanStatic`

Control Pre trial cpss mean = `r pre_trial_cpss_meanControl`

Control Post trial cpss mean = `r post_trial_cpss_meanControl`

Animated Pre trial cpss mean = `r pre_trial_cpss_meanAnimated`

Animated Post trial cpss mean = `r post_trial_cpss_meanAnimated`


Static Pre trial or mean = `r pre_trial_or_meanStatic`

Static Post trial or mean = `r post_trial_or_meanStatic`

Control Pre trial or mean = `r pre_trial_or_meanControl`

Control Post trial or mean = `r post_trial_or_meanControl`

Animated Pre trial or mean = `r pre_trial_or_meanAnimated`

Animated Post trial or mean = `r post_trial_or_meanAnimated`


## Inferential statistics

## Statistical tests
```{r Shapiro-Wilk, include=FALSE}

#perform shapiro-wilk test
result_sw_ptcpss <- shapiro.test(patient_data$pre_trial_cpss)
result_sw_ptcpss
result_sw_postcpss <- shapiro.test(patient_data$post_trial_cpss)
result_sw_postcpss
result_sw_ptor <- shapiro.test(patient_data$pre_trial_or)
result_sw_ptor
result_sw_postor <- shapiro.test(patient_data$post_trial_or)
result_sw_postor


```

A `r result_sw_ptcpss$method` was conducted on each of the data sets

**Pre-trial CPSS SW Result =** `r round(result_sw_ptcpss$p.value, 4)`

**Post-trial CPSS SW Result =** `r round(result_sw_postcpss$p.value, 4)`

**Pre-trial OR SW Result =** `r round(result_sw_ptor$p.value, 4)`

**Post-trial OR SW Result =** `r round(result_sw_postor$p.value, 4)`


From the output obtained we can assume normality for the pre and post trial CPSS as the p-value is greater than 0.05 while the OR data fails this normality test.  

## Confidence Intervals
```{r Confidence Interval, include=FALSE}

#perform 95% Confidence Interval test
ci_error_precpss <- qt(0.975,df=length(patient_data$pre_trial_cpss)-1)*sd(patient_data$pre_trial_cpss)/sqrt(length(patient_data$pre_trial_cpss))
ci_error_precpss_left <- mean(patient_data$pre_trial_cpss)-ci_error_precpss
ci_error_precpss_right <- mean(patient_data$pre_trial_cpss)+ci_error_precpss

ci_error_postcpss <- qt(0.975,df=length(patient_data$post_trial_cpss)-1)*sd(patient_data$post_trial_cpss)/sqrt(length(patient_data$post_trial_cpss))
ci_error_postcpss_left <- mean(patient_data$post_trial_cpss)-ci_error_postcpss
ci_error_postcpss_right <- mean(patient_data$post_trial_cpss)+ci_error_postcpss

ci_error_preor <- qt(0.975,df=length(patient_data$pre_trial_or)-1)*sd(patient_data$pre_trial_or)/sqrt(length(patient_data$pre_trial_or))
ci_error_preor_left <- mean(patient_data$pre_trial_or)-ci_error_preor
ci_error_preor_right <- mean(patient_data$pre_trial_or)+ci_error_preor

ci_error_postor <- qt(0.975,df=length(patient_data$post_trial_or)-1)*sd(patient_data$post_trial_or)/sqrt(length(patient_data$post_trial_or))
ci_error_postor_left <- mean(patient_data$post_trial_or)-ci_error_postor
ci_error_postor_right <- mean(patient_data$post_trial_or)+ci_error_postor


```

**95% CI for pre-trial CPSS =** (`r ci_error_precpss_left` , `r ci_error_precpss_right`)

**95% CI for post-trial CPSS =** (`r ci_error_postcpss_left` , `r ci_error_postcpss_right`)

**95% CI for pre-trial OR  =** (`r ci_error_preor_left` , `r ci_error_preor_right`)

**95% CI for post-trial OR =** (`r ci_error_postor_left` , `r ci_error_postor_right`)



## Magnitude and direction of results

# Discussion

## Outline findings and relation to the hypothesis

## Limitations (if confounding variables are clearly identified by your group)

# References
Help with getting mean of data while data is missing from column *[Stack Overflow](https://stackoverflow.com/questions/23163863/mean-of-a-column-in-a-data-frame-given-the-columns-name)

Removing Na's by Column *[GeeksforGeeks](https://www.geeksforgeeks.org/remove-rows-with-na-in-one-column-of-r-dataframe/)

How to Handle Missing Data in a Dataset *[freeCodeCamp](https://www.freecodecamp.org/news/how-to-handle-missing-data-in-a-dataset/)

How to Impute Missing Values in R? *[GeeksforGeeks](https://www.geeksforgeeks.org/how-to-impute-missing-values-in-r/)

First 10 entries in a bar plot
*[StackOverflow](https://stackoverflow.com/questions/37524701/how-do-i-barplot-only-the-first-10-entries-in-a-frequency-table-in-r)

Calculate confidence interval *[Cyclismo](https://www.cyclismo.org/tutorial/R/confidence.html)
